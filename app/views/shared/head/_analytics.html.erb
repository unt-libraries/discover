<% if Rails.env.production? or Rails.env.development? %>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script>
  var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack || window.msDoNotTrack);
  var respectDnt = (dnt == '1' || dnt === 'yes');

  if (!respectDnt) {
    // Load Google Analytics
    var gaUrl = 'https://www.google-analytics.com/analytics<%#= '_debug' if Rails.env.development? %>.js';
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script',gaUrl,'ga');

    // Load additional external tracking scripts
    (function(d) {
      var wf = d.createElement('script'), s = d.scripts[0];
      wf.src = '<%= asset_pack_path "analytics.js" %>';
      wf.async = true;
      s.parentNode.insertBefore(wf, s);
    })(document);
  } else {
    console.log('Respecting browser Do Not Track')
  }
</script>
<%#= javascript_pack_tag 'analytics', 'data-turbolinks-track': 'reload', defer: true %>
<% end %>
