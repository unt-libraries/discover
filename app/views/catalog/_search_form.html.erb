<%= form_tag search_action_url, method: :get, class: 'search-query-form  search__form', role: 'search' do %>
  <%= render_hash_as_hidden_fields(search_state.params_for_search.except(:q, :search_field, :qt, :page, :utf8)) %>

  <label for="q" class="search__label <% if request.original_url == root_url %>sr-only<% end %>"><%= t('blacklight.search.form.search.label') %></label>
  <div class="input-group">
    <%= text_field_tag :q, params[:q], placeholder: t('blacklight.search.form.search.placeholder'),
                       class: "search-q q form-control search__input", id: "q", autofocus: presenter.autofocus?,
                       data: { autocomplete_enabled: presenter.autocomplete_enabled?,
                               autocomplete_path: search_action_path(action: :suggest) }  %>

    <div class="input-group-append">
    <% if search_fields.length > 1 %>
      <button id="search-fields" class="btn dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <%= t('blacklight.search.form.search_field.label') %>
        <span class="selected"><%= @response %></span>
      </button>
      <%= select_tag(:search_field,
                     options_for_select(search_fields, h(params[:search_field])),
                     title: t('blacklight.search.form.search_field.title'),
                     # type: "button",
                     id: "search_field",
                     class: "dropdown-menu search-field search__btn",
                     'aria-labelledby': "search-fields") %>
    <% elsif search_fields.length == 1 %>
      <%= hidden_field_tag :search_field, search_fields.first.last %>
    <% end %>

      <button type="submit" class="btn btn-primary search-btn" id="search">
        <%= blacklight_icon :search %>
        <span class="submit-search-text"><%= t('blacklight.search.form.submit') %></span>
      </button>
    </div>
  </div>
<% end %>
